{% extends "gold_digger/base.html" %}
<!DOCTYPE html>
<html>
<head>
</head>


<body>
{% block nav %}
    <span id='csrf'>{% csrf_token %}</span>
    <input class="hidden" id="pointer" value="{{ pointer }}">
    <div class="row">
        <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
            {% if user.user.is_authenticated %}
                <div class="notices pull-right">
                    <p class="navbar-brand"> {{ user.user.username }} / <a href="/gold_digger/logout/">Logout</a></p>
                </div>
            {% endif %}
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="glyphicon glyphicon-chevron-down"></span>
                    MENU
                </button>
                <a href="/gold_digger/" class="navbar-brand">Gold Digger</a>
            </div>

            <div class="collapse navbar-collapse" id="collapse">
                <ul class="nav navbar-nav">
                    {% if user.is_authenticated %}
                        <li class="active"><a href="/gold_digger/game_choice2/">Play</a></li>
                    {% endif %}
                    <li><a href="/gold_digger/leaderboards/">Leaderboards</a></li>
                    <li><a href="/gold_digger/about/">About</a></li>
                    <li><a href="how_to_play.html">How to Play</a></li>
                </ul>

            </div>
        </nav>
    </div>

{% endblock %}
{% block body_block %}

    <!-- Header -->

    <div class="jumbotron game" id="{{ location }}_landscape">
    <h1>{{ location }}</h1>
    <h2 class="animated swing">Mine: {{ mine_no }}</h2>
        <br>
    </div>

    <div class="row dig_view">
        <hr>
        <!-- a few empty columns on the left. -->

        <div class="col-xs-3" id="side">

            <div class="well equipment" id="well">

                <!-- Player stats -->
                <table class="equip">
                    <tr class="animated bounceInDown" id="equip">
                        <td class="def">Equipment</td>
                        <td><img src="{{ user.equipment.image.url }}"
                                               title="{{ user.equipment.name }}, modifier: {{ user.equipment.modifier }}"
                                               id="img"></td>
                    </tr>
                    <tr class="animated bounceInDown">
                        <td class="def">Vehicle</td>
                        <td><img src="{{ user.vehicle.image.url }}"
                                               title="{{ user.vehicle.name }}, modifier: {{ user.vehicle.modifier }}"
                                               id="img"></td>
                    </tr>
                    <tr class="animated bounceInDown">
                        <td class="def">Tool</td>
                        <td><img src="{{ user.tool.image.url }}"
                                               title="{{ user.tool.name }}, modifier: {{ user.tool.modifier }}"
                                               id="img">
                        </td>
                    </tr>

                    <!-- Begin  JQuery Ajax -->
                </table>
                <hr>
                <table class="scores">
                    <tr class="animated fadeInLeft">
                        <td><img class="chest" src="/media/icons/Items/Chest.png"></td>
                        <td class="current">Total gold:</td>
                        <td id="totalgold">{{ user.gold }}</td>
                    </tr>

                    <tr class="animated fadeInRight">
                        <td><img class="chest" src="/media/icons/Items/pile2.png" height="32px" width="50px"></td>
                        <td class="current">Current gold:</td>
                        <td id="currentgold"> {{ request.session.gold }}</td>
                    </tr>

                </table>
                <div class="animated fadeInLeft" style="font-size: medium; margin-top: 2%">Time remaining:</div>
                <div class="progress animated fadeInRight">
                    <div class="progress-bar" role="progressbar" aria-valuenow="{{ time_remaining }}"
                         aria-valuemin="100"
                         aria-valuemax="0" style="width: {{ time_remaining }}%;">
                            <span id="time">{{ time_remaining }}%</span>

                    </div>

                </div>

            </div>

        </div>
        <div class="col-xs-1" id="side"></div>

        <!-- Mine -->

        {% if blocks %}
            <div class="col-xs-5 mine">
                {% for block in blocks %}
                    {% if block.dug == False %}
                    <div class="row flecks_{{ block.cue }} animated" id="goldlayer_{{ block.pos }}">
                        <div class="scaffold_1_shaded" id="scaffoldlayer_{{ block.pos }}">
                            <div class="points" id="points_{{ block.pos }}"></div>
                            <div class="comment" id="comment_{{ block.pos }}"></div>
                        </div>
                    </div>
                {% else %}
                        <div class="row nuggets_{{ block.cue }}" id="goldlayer_{{ block.pos }}">
                        <div class="scaffold_3" id="scaffoldlayer_{{ block.pos }}">
                            <div class="points" id="points_{{ block.pos }}"></div>
                            <div class="comment" id="comment_{{ block.pos }}"></div>
                        </div>
                    </div>
                {% endif %}

                {% endfor %}

            </div>

            <!-- Buttons -->
            <div class="col-xs-3 mine" >
                {% for block in blocks %}

                    {% if block.pos == pointer %}
                        <div class="" id="row_{{ block.pos }}">
                            <div class="buttons" id="invisiblebuttons_{{ block.pos }}">
                                <button type="submit" class="button btn-group-sm" value="{{ block.gold }}" name="dig"
                                        id="digbutton_{{ block.pos }}"> dig ({{ dig_cost }})
                                </button>
                                <input type="hidden" value="{{ block.pos }}" name="block"
                                       id="blockposition_{{ block.pos }}"/>
                            </div>
                            <form class="move" action="/gold_digger/move/" method="post" id="movebutton_{{ block.pos }}">
                                {% csrf_token %}
                                <button type="submit" class="button btn-group-sm" value="move mine" name="move"
                                        id="controls">move ({{ move_cost }})
                                </button>
                            </form>
                        </div>
                     {% elif block.dug == True %}
                         <div class='row' id='resultcol'>--- <img src='/media/icons/Items/Gold.png'>--- <img src='/media/icons/Items/Chest.png'></div>
                    {% elif block.dug == False %}
                        <div class=""  id="row_{{ block.pos }}">
                            <div class="buttons hidden" id="invisiblebuttons_{{ block.pos }}">
                                <button type="submit" class="button btn-group-sm" value="{{ block.gold }}" name="dig" id="digbutton_{{ block.pos }}"> dig ({{ dig_cost }})</button>

                                <input type="hidden" value="{{ block.pos }}" name="block"
                                       id="blockposition_{{ block.pos }}"/>
                            </div>
                            <form class="move hidden row" action="/gold_digger/move/" method="post" id="movebutton_{{ block.pos }}">
                                {% csrf_token %}
                                <button type="submit" class="button btn-group-sm" value="move mine" name="move"
                                        id="controls">move ({{ move_cost }})
                                </button>
                            </form>
                        </div>

                    {% endif %}

                {% endfor %}

            </div>

            </div>

        {% endif %}

{% endblock %}
</body>
</html>