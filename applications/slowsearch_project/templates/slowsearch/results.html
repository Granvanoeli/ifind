{% extends 'slowsearch/base.html' %}
{% load static %}


{% block body_block %}

<script type="text/javascript">

    $(document).ready(function() {
        var throbber_val = $('#show_throbber').val();

        if (throbber_val == 'True') {
            showThrobber();
        }
    });

    function showThrobber() {
         document.getElementById('progress').style.visibility='visible';
         document.getElementById('results').style.opacity='0.5';
         document.getElementById('results').style.pointerEvents="none";
        document.getElementById('results_inner').style.visibility="hidden";
         setTimeout("document.getElementById('progress').style.visibility='hidden'", 5000);
         setTimeout("document.getElementById('results').style.opacity='1'", 5000);
         setTimeout("document.getElementById('results_inner').style.visibility='visible'", 5000);
         setTimeout("document.getElementById('results').style.pointerEvents='auto'", 5000);
    }
</script>

        <input type="hidden" value="{{ show_throbber}}" id="show_throbber"/>
      <div class="modal" id="progress" style="visibility: hidden">
                 <img src="{% static "throbber.GIF" %}" alt="Progress Spinner" height="45" width="45"/>
            </div>

    <div id="results" style="width: 40%; margin-left: 10%">

            <form id="search" action="/search/" method="post">
                {% csrf_token %}
                <input type=text style="width: 80%; vertical-align: top" name=query value="{{ query }}">
                {% if not request.user.id|divisibleby:2 %}
                     <input class="btn-primary" style="vertical-align: top; height: 30px" id="SearchDelay" type=submit value="Search">
                {% else %}
                    <input class="btn-primary" style="vertical-align: top; height: 30px;" type=submit value="Search">
                {% endif %}
            </form>
    <div id="results_inner">
        {% if contacts %}
            {% if "Unable to connect" in contacts %}
            <p class="text-error">{{ contacts }}</p>
             {% else %}
             {% for contact in contacts %}
                {% if contact.url %}
                    <div>
                    <strong style="font-size: 13pt"><a href="/goto/{{ contact.url }}/{{ contact.rank }}">{{ contact.title }}</a></strong><br />
                    <div style="font-size: smaller; color: green">{% if contact.url|length > 70 %}{{ contact.url|slice:"70" }}...
                    {% else %}{{ contact.url }}{% endif %}</div>
                    <em>{{ contact.summary }}</em>
                    <br><br>
                    </div>
                {% endif %}
             {% endfor %}
         {% endif %}
        {% else %}
        <p class="alert">No results found. Please try a different query.</p>
        {% endif %}
        <br>
    <div align="center">
        {% if not "Unable to connect" in contacts and contacts %}
            {% if contacts.has_previous %}
                 <a href="?query={{ query }}&page={{ contacts.previous_page_number }}">Previous</a>
            {% endif %}
                 Page {{ contacts.number }} of {{ contacts.paginator.num_pages }}

            {% if contacts.has_next %}
                <a href="?query={{ query }}&page={{ contacts.next_page_number }}">Next</a><br>
            {% endif %}
        {% endif %}
    </div>
    </div>
        </div>

{% endblock %}